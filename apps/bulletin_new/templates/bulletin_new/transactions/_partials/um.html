{% load uma_extras %}

{% if transaction_type.title == 'Зміна адреси для листування' %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>Причина</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.REASON }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% elif transaction_type.title == "Припинення чинності майнових прав інтелектуальної власності у зв'язку із закінченням строку дії" %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>Дата припинення дії патенту (деклараційного патенту)</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.DATEFACTSTOP|parse_date|date:"d.m.Y" }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% elif transaction_type.title == "Припинення чинності майнових прав інтелектуальної власності у разі несплати річного збору" %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>Дата припинення дії патенту (деклараційного патенту)</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.DATEFACTSTOP|parse_date|date:"d.m.Y" }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% elif transaction_type.title == "Передача права власності" %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>Причина</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.REASON }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% elif transaction_type.title == "Зміна імені (найменування) та (або) адреси чи особи володільця патенту" %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>(73) Власник</th>
            <th>Причина</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.INID_73 }}</td>
                <td>{{ transaction_data.REASON }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% elif transaction_type.title == "Зміна складу винахідників" %}
    <table class="table table-bordered table-sm">
        <thead>
        <tr>
            <th>(21) Номер заявки</th>
            <th>(11) Номер патенту (деклараційного патенту)</th>
            <th>(72) Винахідник</th>
            <th>Причина</th>
        </tr>
        </thead>

        <tbody>
        {% for transaction in transactions %}
            {% json_to_dict transaction.json_data as transaction_data %}
            <tr>
                <td>
                    <a href="{% url 'search:detail' pk=transaction.application.pk %}"
                       target="_blank">{{ transaction.application.app_number }}</a>
                </td>
                <td>{{ transaction.application.registration_number }}</td>
                <td>{{ transaction_data.INID_72 }}</td>
                <td>{{ transaction_data.REASON }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% else %}
    {% for transaction in transactions %}
        {% json_to_dict transaction.json_data as transaction_data %}
        <pre>{{ transaction_data|pprint }}</pre>
    {% endfor %}
{% endif %}